<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>
Tesseroids v1.0
</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/> 
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="logo.ico"/>
</head>

<body>

<table cellspacing=20>
    <tr>
    <td> <img src="logo.png" alt="Logo" height=50 width=50> </td>
    <td align="center"> <font size=6>
    <b>Tesseroids 1.0</b>: User Manual and API Documentation </font></td>
</table>

<div class="supertabs">
    <ul class="tablist">
        <li><a href="index.html"><span>Main&#160;Page</span></a>
            <ul class="subtablist">
                <li><a href="http://code.google.com/p/tesseroids"><span>Project site</span></a></li>
                <li><a href="http://code.google.com/p/tesseroids/downloads/list"><span>Download</span></a></li>
                <li><a href="http://www.gnu.org/licenses/gpl.html"><span>License</span></a></li>
            </ul>
        </li>
        <li><a href="userman.html"><span>User&#160;Manual</span></a>
            <ul class="subtablist">
                <li><a href="userman-theory.html"><span>Theory</span></a></li>
                <li><a href="userman-instal.html"><span>Intallation</span></a></li>
                <li><a href="userman-usage.html"><span>Usage</span></a></li>
            </ul>
        </li>
        <li><a href="apidocs.html"><span>API&#160;Documentation</span></a>
            <ul class="subtablist">
                <li><a href="files.html"><span>Files</span></a></li>
                <li><a href="annotated.html"><span>Data Structures</span></a></li>
                <li><a href="globals_func.html"><span>Functions</span></a></li>
                <li><a href="todo.html"><span>To do</span></a></li>
            </ul>
        </li>
    </ul>
</div>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>C:/Users/Leo/tesseroids/src/c/grav_tess.h File Reference</h1>  </div>
</div>
<div class="contents">

<p>Functions that calculate the gravitational potential and its first and second derivatives for the tesseroid.  
<a href="#_details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="utils_8h_source.html">utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="glq_8h_source.html">glq.h</a>&quot;</code><br/>
</div>
<p><a href="grav__tess_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#ac232752316d7f9a63e127025e8b751c9">calc_tess_model</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> *model, int size, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> *glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> *glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> *glq_r, double(*field)(<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>, double, double, double, <a class="el" href="struct_g_l_q.html">GLQ</a>, <a class="el" href="struct_g_l_q.html">GLQ</a>, <a class="el" href="struct_g_l_q.html">GLQ</a>))</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the field of a tesseroid model at a given point.  <a href="#ac232752316d7f9a63e127025e8b751c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#a333041619d1b096197b680a789fa51e8">calc_tess_model_adapt</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> *model, int size, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> *glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> *glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> *glq_r, double(*field)(<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>, double, double, double, <a class="el" href="struct_g_l_q.html">GLQ</a>, <a class="el" href="struct_g_l_q.html">GLQ</a>, <a class="el" href="struct_g_l_q.html">GLQ</a>))</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adaptatively calculate the field of a tesseroid model at a given point by splitting the tesseroids if necessary to maintain <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> stability.  <a href="#a333041619d1b096197b680a789fa51e8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#a6967aad02a14a991a30600b5fa8fbf4e">tess_gx</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gx caused by a tesseroid.  <a href="#a6967aad02a14a991a30600b5fa8fbf4e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#af5c902b0c0b13b88509f5d279e92554c">tess_gy</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gy caused by a tesseroid.  <a href="#af5c902b0c0b13b88509f5d279e92554c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#a951a4ed90afbac9707b5ea289ceb0208">tess_gz</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gz caused by a tesseroid.  <a href="#a951a4ed90afbac9707b5ea289ceb0208"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#af5150cab79c8e065cb33a4a87de2ee6b">tess_gxx</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gxx caused by a tesseroid.  <a href="#af5150cab79c8e065cb33a4a87de2ee6b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#a3072dd5fa4cd846ce13e6cee1fd205b7">tess_gxy</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gxy caused by a tesseroid.  <a href="#a3072dd5fa4cd846ce13e6cee1fd205b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#a59ce447021f75ccef3a1f76486e2a9f1">tess_gxz</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gxz caused by a tesseroid.  <a href="#a59ce447021f75ccef3a1f76486e2a9f1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#a3af7ce772fca03748be42057c3e3062a">tess_gyy</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gyy caused by a tesseroid.  <a href="#a3af7ce772fca03748be42057c3e3062a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#ab7b85b2dbf324fb053355676b57990f1">tess_gyz</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gyz caused by a tesseroid.  <a href="#ab7b85b2dbf324fb053355676b57990f1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="grav__tess_8h.html#a46301016cc20914f7ffce3491c35effb">tess_gzz</a> (<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> tess, double lonp, double latp, double rp, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lon, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_lat, <a class="el" href="struct_g_l_q.html">GLQ</a> glq_r)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates gzz caused by a tesseroid.  <a href="#a46301016cc20914f7ffce3491c35effb"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Functions that calculate the gravitational potential and its first and second derivatives for the tesseroid. </p>
<p>The gravity gradients can be calculated using the general formula:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{\alpha\beta}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} I_{\alpha\beta}\ d r' d \phi' d \lambda' \ \ \alpha,\beta \in \{1,2,3\} \]" src="form_24.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ I_{\alpha\beta} = \left(\frac{3\Delta x_i \Delta x_j}{\ell^5} - \frac{\delta_{ij}}{\ell^3} \right)\kappa\ \]" src="form_25.png"/>
</p>
<p>and solved using the Gauss-Legendre Quadrature rule:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{\alpha\beta}(r_p,\phi_p,\lambda_p) \approx G \rho \frac{(\lambda_2 - \lambda_1) (\phi_2 - \phi_1)(r_2 - r_1)}{8} \displaystyle\sum_{k=0}^{N^{\lambda} - 1} \displaystyle\sum_{j=0}^{N^{\phi} - 1} \displaystyle\sum_{i=0}^{N^r - 1} W^r_i W^{\phi}_j W^{\lambda}_k I_{\alpha\beta}({r'}_i, {\phi'}_j, {\lambda'}_k )\kappa\ \ \alpha,\beta \in \{1,2,3\} \]" src="form_26.png"/>
</p>
<p>where <img class="formulaInl" alt="$ \rho $" src="form_27.png"/> is density, the subscripts 1, 2, and 3 should be interpreted as the x, y, and z axis and</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \Delta x_1 &amp;=&amp; r' K_{\phi} \\ \Delta x_2 &amp;=&amp; r' \cos \phi' \sin(\lambda' - \lambda_p) \\ \Delta x_3 &amp;=&amp; r' \cos \psi - r_p\\ \ell &amp;=&amp; \sqrt{r'^2 + r_p^2 - 2 r' r_p \cos \psi} \\ \cos\psi &amp;=&amp; \sin\phi_p\sin\phi' + \cos\phi_p\cos\phi' \cos(\lambda' - \lambda_p) \\ K_{\phi} &amp;=&amp; \cos\phi_p\sin\phi' - \sin\phi_p\cos\phi' \cos(\lambda' - \lambda_p)\\ \kappa &amp;=&amp; {r'}^2 \cos \phi' \end{eqnarray*}" src="form_28.png"/>
</p>
<p><img class="formulaInl" alt="$ \phi $" src="form_10.png"/> is latitude, <img class="formulaInl" alt="$ \lambda $" src="form_11.png"/> is longitude, <img class="formulaInl" alt="$ r $" src="form_12.png"/> is radius. The subscript <img class="formulaInl" alt="$ p $" src="form_14.png"/> is for the computation point.</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;Up</b> (away from center of the Earth).</p>
<p>To maintain the standard convention, only for component gz the z axis is inverted, so a positive density results in positive gz.</p>
<p><b>Example</b>:</p>
<p>To calculate the gzz component due to a tesseroid on a regular grid.</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &quot;<a class="code" href="glq_8h.html" title="Functions for implementing a Gauss-Legendre Quadrature numerical integration.">glq.h</a>&quot;</span>r
<span class="preprocessor">#include &quot;<a class="code" href="constants_8h.html" title="Define constants used, like the gravitational constant and unit conversions.">constants.h</a>&quot;</span>
<span class="preprocessor">#include &quot;<a class="code" href="grav__tess_8h.html" title="Functions that calculate the gravitational potential and its first and second derivatives for the tes...">grav_tess.h</a>&quot;</span>

<span class="keywordtype">int</span> <a class="code" href="prismgx_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="Main.">main</a>()
{
    <a class="code" href="struct_t_e_s_s_e_r_o_i_d.html" title="Store information on a tesseroid.">TESSEROID</a> tess = {1000, 44, 46, -1, 1, <a class="code" href="constants_8c.html#ac7656d4c0a64de6a85b5751694599af9" title="Mean Earth radius [ ].">MEAN_EARTH_RADIUS</a> - 100000,
                      <a class="code" href="constants_8c.html#ac7656d4c0a64de6a85b5751694599af9" title="Mean Earth radius [ ].">MEAN_EARTH_RADIUS</a>};
    <a class="code" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> *glqlon, *glqlat, *glqr;
    <span class="keywordtype">double</span> lon, lat, r = <a class="code" href="constants_8c.html#ac7656d4c0a64de6a85b5751694599af9" title="Mean Earth radius [ ].">MEAN_EARTH_RADIUS</a> + 1500000, res;
    <span class="keywordtype">int</span> order = 8;
    
    glqlon = <a class="code" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new</a>(order, tess.<a class="code" href="struct_t_e_s_s_e_r_o_i_d.html#afb3248bab1c7ee0ad97e9d4c275b4c67" title="western longitude border in degrees">w</a>, tess.<a class="code" href="struct_t_e_s_s_e_r_o_i_d.html#ab17e17fb32b792781b807505e7f60c9c" title="eastern longitude border in degrees">e</a>);
    glqlat = <a class="code" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new</a>(order, tess.<a class="code" href="struct_t_e_s_s_e_r_o_i_d.html#ad62e712560f6344b96d4c080a2ba9c92" title="southern latitude border in degrees">s</a>, tess.<a class="code" href="struct_t_e_s_s_e_r_o_i_d.html#abe63e991a7bf5d666068b15c9064428d" title="northern latitude border in degrees">n</a>);
    glqr = <a class="code" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new</a>(order, tess.<a class="code" href="struct_t_e_s_s_e_r_o_i_d.html#a636240abcfe01b37aedcf389075c0916" title="smallest radius border in SI units">r1</a>, tess.<a class="code" href="struct_t_e_s_s_e_r_o_i_d.html#a9c7bfbe56a69ec779a2877fe5ccb5cd6" title="largest radius border in SI units">r2</a>);

    <span class="keywordflow">for</span>(lat = 20; lat &lt;= 70; lat += 0.5)
    {
        <span class="keywordflow">for</span>(lon = -25; lon &lt;= 25; lon += 0.5)
        {
            res = <a class="code" href="grav__tess_8c.html#a46301016cc20914f7ffce3491c35effb" title="Calculates gzz caused by a tesseroid.">tess_gzz</a>(tess, lon, lat, r, *glqlon, *glqlat, *glqr);
            printf(<span class="stringliteral">&quot;%g %g %g\n&quot;</span>, lon, lat, res);
        }
    }

    <a class="code" href="glq_8c.html#ad3b24d3856ed70739ea6ad31a4c20260" title="Free the memory allocated to make a GLQ structure.">glq_free</a>(glqlon);
    <a class="code" href="glq_8c.html#ad3b24d3856ed70739ea6ad31a4c20260" title="Free the memory allocated to make a GLQ structure.">glq_free</a>(glqlat);
    <a class="code" href="glq_8c.html#ad3b24d3856ed70739ea6ad31a4c20260" title="Free the memory allocated to make a GLQ structure.">glq_free</a>(glqr);

    <span class="keywordflow">return</span> 0;
}
</pre></div><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd><p class="startdd">Possible speed up: use pointers for weights and nodes </p>
<p>Put reference for formulas </p>
<p class="enddd">Allow for tesseroids with depth varying density</p>
</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Leonardo Uieda </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>27 Jan 2011 </dd></dl>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac232752316d7f9a63e127025e8b751c9"></a><!-- doxytag: member="grav_tess.h::calc_tess_model" ref="ac232752316d7f9a63e127025e8b751c9" args="(TESSEROID *model, int size, double lonp, double latp, double rp, GLQ *glq_lon, GLQ *glq_lat, GLQ *glq_r, double(*field)(TESSEROID, double, double, double, GLQ, GLQ, GLQ))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_tess_model </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a> *&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a> *&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a> *&#160;</td>
          <td class="paramname"><em>glq_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>, double, double, double, <a class="el" href="struct_g_l_q.html">GLQ</a>, <a class="el" href="struct_g_l_q.html">GLQ</a>, <a class="el" href="struct_g_l_q.html">GLQ</a>)&#160;</td>
          <td class="paramname"><em>field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the field of a tesseroid model at a given point. </p>
<p>Uses a function pointer to call one of the apropriate field calculating functions:</p>
<ul>
<li><a class="el" href="grav__tess_8c.html#a6967aad02a14a991a30600b5fa8fbf4e" title="Calculates gx caused by a tesseroid.">tess_gx()</a></li>
<li><a class="el" href="grav__tess_8c.html#af5c902b0c0b13b88509f5d279e92554c" title="Calculates gy caused by a tesseroid.">tess_gy()</a></li>
<li><a class="el" href="grav__tess_8c.html#a951a4ed90afbac9707b5ea289ceb0208" title="Calculates gz caused by a tesseroid.">tess_gz()</a></li>
<li><a class="el" href="grav__tess_8c.html#af5150cab79c8e065cb33a4a87de2ee6b" title="Calculates gxx caused by a tesseroid.">tess_gxx()</a></li>
<li><a class="el" href="grav__tess_8c.html#a3072dd5fa4cd846ce13e6cee1fd205b7" title="Calculates gxy caused by a tesseroid.">tess_gxy()</a></li>
<li><a class="el" href="grav__tess_8c.html#a59ce447021f75ccef3a1f76486e2a9f1" title="Calculates gxz caused by a tesseroid.">tess_gxz()</a></li>
<li><a class="el" href="grav__tess_8c.html#a3af7ce772fca03748be42057c3e3062a" title="Calculates gyy caused by a tesseroid.">tess_gyy()</a></li>
<li><a class="el" href="grav__tess_8c.html#ab7b85b2dbf324fb053355676b57990f1" title="Calculates gyz caused by a tesseroid.">tess_gyz()</a></li>
<li><a class="el" href="grav__tess_8c.html#a46301016cc20914f7ffce3491c35effb" title="Calculates gzz caused by a tesseroid.">tess_gzz()</a></li>
</ul>
<p>To pass a function pointer to a function use something like:</p>
<div class="fragment"><pre class="fragment">
calc_tess_model(my_model, 10, 0, 10, 1, glqlon, glqlat, glqr, &amp;tess_gx);
</pre></div><p>This would calculate the gx effect of the model my_model with 10 tesseroids at lon=0 lat=10 r=1.</p>
<p>Will re-use the same <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structures, and therefore the <b>same order, for all the tesseroids</b>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html" title="Store information on a tesseroid.">TESSEROID</a> array defining the model </td></tr>
    <tr><td class="paramname">size</td><td>number of tesseroids in the model </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td>pointer to <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure used for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td>pointer to <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure used for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td>pointer to <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure used for the radial integration </td></tr>
    <tr><td class="paramname">field</td><td>pointer to one of the field calculating functions</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the sum of the fields of all the tesseroids in the model </dd></dl>

</div>
</div>
<a class="anchor" id="a333041619d1b096197b680a789fa51e8"></a><!-- doxytag: member="grav_tess.h::calc_tess_model_adapt" ref="a333041619d1b096197b680a789fa51e8" args="(TESSEROID *model, int size, double lonp, double latp, double rp, GLQ *glq_lon, GLQ *glq_lat, GLQ *glq_r, double(*field)(TESSEROID, double, double, double, GLQ, GLQ, GLQ))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_tess_model_adapt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a> *&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a> *&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a> *&#160;</td>
          <td class="paramname"><em>glq_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(*)(<a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>, double, double, double, <a class="el" href="struct_g_l_q.html">GLQ</a>, <a class="el" href="struct_g_l_q.html">GLQ</a>, <a class="el" href="struct_g_l_q.html">GLQ</a>)&#160;</td>
          <td class="paramname"><em>field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adaptatively calculate the field of a tesseroid model at a given point by splitting the tesseroids if necessary to maintain <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> stability. </p>
<p>See <a class="el" href="grav__tess_8c.html#ac232752316d7f9a63e127025e8b751c9" title="Calculates the field of a tesseroid model at a given point.">calc_tess_model()</a> for more details.</p>
<p>Will re-use the same <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structures, and therefore the <b>same order, for all the tesseroids</b>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html" title="Store information on a tesseroid.">TESSEROID</a> array defining the model </td></tr>
    <tr><td class="paramname">size</td><td>number of tesseroids in the model </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td>pointer to <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure used for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td>pointer to <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure used for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td>pointer to <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure used for the radial integration </td></tr>
    <tr><td class="paramname">field</td><td>pointer to one of the field calculating functions</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the sum of the fields of all the tesseroids in the model </dd></dl>

</div>
</div>
<a class="anchor" id="a6967aad02a14a991a30600b5fa8fbf4e"></a><!-- doxytag: member="grav_tess.h::tess_gx" ref="a6967aad02a14a991a30600b5fa8fbf4e" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gx caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_x(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{r'K_{\phi}}{\ell^3}\kappa \ d r' d \phi' d \lambda' \]" src="form_29.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in mGal!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
<a class="anchor" id="af5150cab79c8e065cb33a4a87de2ee6b"></a><!-- doxytag: member="grav_tess.h::tess_gxx" ref="af5150cab79c8e065cb33a4a87de2ee6b" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gxx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gxx caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{xx}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{3(r' K_{\phi})^2 - \ell^2}{\ell^5}\kappa \ d r' d \phi' d \lambda' \]" src="form_32.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in Eotvos!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
<a class="anchor" id="a3072dd5fa4cd846ce13e6cee1fd205b7"></a><!-- doxytag: member="grav_tess.h::tess_gxy" ref="a3072dd5fa4cd846ce13e6cee1fd205b7" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gxy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gxy caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{xy}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{3{r'}^2 K_{\phi}\cos\phi'\sin(\lambda' - \lambda_p)}{\ell^5} \kappa \ d r' d \phi' d \lambda' \]" src="form_33.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in Eotvos!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
<a class="anchor" id="a59ce447021f75ccef3a1f76486e2a9f1"></a><!-- doxytag: member="grav_tess.h::tess_gxz" ref="a59ce447021f75ccef3a1f76486e2a9f1" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gxz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gxz caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{xz}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{3 r' K_{\phi}(r' \cos\psi - r_p)}{\ell^5}\kappa \ d r' d \phi' d \lambda' \]" src="form_34.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in Eotvos!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
<a class="anchor" id="af5c902b0c0b13b88509f5d279e92554c"></a><!-- doxytag: member="grav_tess.h::tess_gy" ref="af5c902b0c0b13b88509f5d279e92554c" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gy caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_y(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{r'\cos\phi'\sin(\lambda'-\lambda)}{\ell^3}\kappa \ d r' d \phi' d \lambda' \]" src="form_30.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in mGal!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
<a class="anchor" id="a3af7ce772fca03748be42057c3e3062a"></a><!-- doxytag: member="grav_tess.h::tess_gyy" ref="a3af7ce772fca03748be42057c3e3062a" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gyy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gyy caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{yy}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{3(r'\cos\phi'\sin(\lambda' - \lambda_p))^2 - \ell^2}{\ell^5} \kappa \ d r' d \phi' d \lambda' \]" src="form_35.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in Eotvos!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
<a class="anchor" id="ab7b85b2dbf324fb053355676b57990f1"></a><!-- doxytag: member="grav_tess.h::tess_gyz" ref="ab7b85b2dbf324fb053355676b57990f1" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gyz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gyz caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{yz}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{3 r' \cos\phi' \sin(\lambda' - \lambda_p)(r'\cos\psi - r_p)}{\ell^5} \kappa \ d r' d \phi' d \lambda' \]" src="form_36.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in Eotvos!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
<a class="anchor" id="a951a4ed90afbac9707b5ea289ceb0208"></a><!-- doxytag: member="grav_tess.h::tess_gz" ref="a951a4ed90afbac9707b5ea289ceb0208" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gz caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_z(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{r'\cos\psi - r_p}{\ell^3}\kappa \ d r' d \phi' d \lambda' \]" src="form_31.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in mGal!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
<a class="anchor" id="a46301016cc20914f7ffce3491c35effb"></a><!-- doxytag: member="grav_tess.h::tess_gzz" ref="a46301016cc20914f7ffce3491c35effb" args="(TESSEROID tess, double lonp, double latp, double rp, GLQ glq_lon, GLQ glq_lat, GLQ glq_r)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double tess_gzz </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_e_s_s_e_r_o_i_d.html">TESSEROID</a>&#160;</td>
          <td class="paramname"><em>tess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lonp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_l_q.html">GLQ</a>&#160;</td>
          <td class="paramname"><em>glq_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates gzz caused by a tesseroid. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{zz}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{3(r'\cos\psi-r_p)^2 - \ell^2}{\ell^5}\kappa \ d r' d \phi' d \lambda' \]" src="form_37.png"/>
</p>
<p>The derivatives of the potential are made with respect to the local coordinate system <b>x-&gt;North, y-&gt;East, z-&gt;out</b></p>
<p><b>Input values in SI units and <b>degrees</b> and returns values in Eotvos!</b></p>
<p>Use function <a class="el" href="glq_8c.html#a3240943c9485ef799e09f2a27ce6f50b" title="Make a new GLQ structure and set all the parameters needed.">glq_new()</a> to create the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> parameters required. The integration limits should be set to:</p>
<ul>
<li>glq_lon: lower = tess.w and upper = tess.e (in degrees)</li>
<li>glq_lat: lower = tess.s and upper = tess.n (in degrees)</li>
<li>glq_r: lower = tess.r1 and upper = tess.r2</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tess</td><td>data structure describing the tesseroid </td></tr>
    <tr><td class="paramname">lonp</td><td>longitude of the computation point P </td></tr>
    <tr><td class="paramname">latp</td><td>latitude of the computation point P </td></tr>
    <tr><td class="paramname">rp</td><td>radial coordinate of the computation point P </td></tr>
    <tr><td class="paramname">glq_lon</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the longitudinal integration </td></tr>
    <tr><td class="paramname">glq_lat</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the latitudinal integration </td></tr>
    <tr><td class="paramname">glq_r</td><td><a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> structure with the nodes, weights and integration limits set for the radial integration</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>field calculated at P </dd></dl>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>
Generated on Tue Feb 15 2011 23:35:01 for Tesseroids 1.0: User manual and API documentation by&nbsp;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3</small></address>
</body>
</html>
