<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>
Tesseroids v1.0
</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/> 
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="logo.ico"/>
</head>

<body>

<table cellspacing=20>
    <tr>
    <td> <img src="logo.png" alt="Logo" height=50 width=50> </td>
    <td align="center"> <font size=6>
    <b>Tesseroids 1.0</b>: User Manual and API Documentation </font></td>
</table>

<div class="supertabs">
    <ul class="tablist">
        <li><a href="index.html"><span>Main&#160;Page</span></a>
            <ul class="subtablist">
                <li><a href="http://code.google.com/p/tesseroids"><span>Project site</span></a></li>
                <li><a href="http://code.google.com/p/tesseroids/downloads/list"><span>Download</span></a></li>
                <li><a href="http://www.gnu.org/licenses/gpl.html"><span>License</span></a></li>
            </ul>
        </li>
        <li><a href="userman.html"><span>User&#160;Manual</span></a>
            <ul class="subtablist">
                <li><a href="userman-theory.html"><span>Theory</span></a></li>
                <li><a href="userman-instal.html"><span>Intallation</span></a></li>
                <li><a href="userman-usage.html"><span>Usage</span></a></li>
            </ul>
        </li>
        <li><a href="apidocs.html"><span>API&#160;Documentation</span></a>
            <ul class="subtablist">
                <li><a href="files.html"><span>Files</span></a></li>
                <li><a href="annotated.html"><span>Data Structures</span></a></li>
                <li><a href="globals_func.html"><span>Functions</span></a></li>
                <li><a href="todo.html"><span>To do</span></a></li>
            </ul>
        </li>
    </ul>
</div>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="contents">


<h1><a class="anchor" id="userman-theory">Theoretical background </a></h1> 
<table border=0>
<tr>
<td width="15%"></td>
<td>
<h2><a class="anchor" id="coordsys">
About Coordinate Systems</a></h2>
<p>The two coordinate systems involved in the computations are the Global and Local coordinate systems.</p>
<p>The Global system has origin on the center of the Earth and Z axis aligned with the Earth's mean rotation axis. The X and Y axis are contained on the equatorial parallel with X intercepting the mean Greenwich meridian and Y completing a right-handed system.</p>
<p>The Local system has origin on the computation point. It's z is oriented along the radial direction and points away from the center of the Earth. The x and y axis are contained on a plane normal to the z axis and x points North and y East.</p>
<p>The tesseroids are defined using the Global Coordinate system with spherical coordinates, while the gravitational fields are calculated on the Local Coordinate system of the computation point.</p>
<p><b>WARNING</b>: The <img class="formulaInl" alt="$ g_z $" src="form_38.png"/> component is an exception to this. In order to conform with the regular convention of z-axis pointing toward the center of the Earth, this component ONLY is calculated with an inverted z axis.</p>
<div align="center">
<img src="tesseroid_coordsys.png" alt="tesseroid_coordsys.png"/>
<p><strong>Figure1: View of a tesseroid, the integration point Q, the global coordinate system, the computation P and it's local coordinate system.</strong></p></div>
 <h2><a class="anchor" id="formulas">
Gravitational Fields of a Tesseroid</a></h2>
<p>The gravitational attraction of a tesseroid can be calculated using the formula:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{\alpha}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} \frac{\Delta x_{\alpha}}{\ell^3} \kappa \ d r' d \phi' d \lambda' \ \ \alpha \in \{1,2,3\} \]" src="form_39.png"/>
</p>
<p>The gravity gradients can be calculated using the general formula:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{\alpha\beta}(r_p,\phi_p,\lambda_p) = G \rho \displaystyle\int_{\lambda_1}^{\lambda_2} \displaystyle\int_{\phi_1}^{\phi_2} \displaystyle\int_{r_1}^{r_2} I_{\alpha\beta}\ d r' d \phi' d \lambda' \ \ \alpha,\beta \in \{1,2,3\} \]" src="form_24.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ I_{\alpha\beta} = \left(\frac{3\Delta x_{\alpha} \Delta x_{\beta}}{\ell^5} - \frac{\delta_{\alpha\beta}}{\ell^3} \right)\kappa\ \ \ \alpha,\beta \in \{1,2,3\} \]" src="form_40.png"/>
</p>
<p>where <img class="formulaInl" alt="$ \rho $" src="form_27.png"/> is density, the subscripts 1, 2, and 3 should be interpreted as the x, y, and z axis, <img class="formulaInl" alt="$ \delta_{\alpha\beta} $" src="form_41.png"/> is the Kronecker delta function, and</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \Delta x_1 &amp;=&amp; r' K_{\phi} \\ \Delta x_2 &amp;=&amp; r' \cos \phi' \sin(\lambda' - \lambda_p) \\ \Delta x_3 &amp;=&amp; r' \cos \psi - r_p\\ \ell &amp;=&amp; \sqrt{r'^2 + r_p^2 - 2 r' r_p \cos \psi} \\ \cos\psi &amp;=&amp; \sin\phi_p\sin\phi' + \cos\phi_p\cos\phi' \cos(\lambda' - \lambda_p) \\ K_{\phi} &amp;=&amp; \cos\phi_p\sin\phi' - \sin\phi_p\cos\phi' \cos(\lambda' - \lambda_p)\\ \kappa &amp;=&amp; {r'}^2 \cos \phi' \end{eqnarray*}" src="form_28.png"/>
</p>
<p><img class="formulaInl" alt="$ \phi $" src="form_10.png"/> is latitude, <img class="formulaInl" alt="$ \lambda $" src="form_11.png"/> is longitude, <img class="formulaInl" alt="$ r $" src="form_12.png"/> is radius. The subscript <img class="formulaInl" alt="$ p $" src="form_14.png"/> is for the computation point.</p>
<h2><a class="anchor" id="glq">
Numerical Integration</a></h2>
<p>The above integrals are solved using the Gauss-Legendre Quadrature rule:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ g_{\alpha\beta}(r_p,\phi_p,\lambda_p) \approx G \rho \frac{(\lambda_2 - \lambda_1) (\phi_2 - \phi_1)(r_2 - r_1)}{8} \displaystyle\sum_{k=0}^{N^{\lambda} - 1} \displaystyle\sum_{j=0}^{N^{\phi} - 1} \displaystyle\sum_{i=0}^{N^r - 1} W^r_i W^{\phi}_j W^{\lambda}_k I_{\alpha\beta}({r'}_i, {\phi'}_j, {\lambda'}_k )\kappa\ \ \alpha,\beta \in \{1,2,3\} \]" src="form_26.png"/>
</p>
<p>where <img class="formulaInl" alt="$ W^r $" src="form_42.png"/>,<img class="formulaInl" alt="$ W^{\phi} $" src="form_43.png"/>, and <img class="formulaInl" alt="$ W^{\lambda} $" src="form_44.png"/> are weighting coefficients and <img class="formulaInl" alt="$ N^r $" src="form_45.png"/>,<img class="formulaInl" alt="$ N^{\phi} $" src="form_46.png"/>, and <img class="formulaInl" alt="$ N^{\lambda} $" src="form_47.png"/> are the number of quadrature nodes, ie the order of the quadrature.</p>
 
</td>
<td width="15%"></td>
</table>
 </div>
<hr class="footer"/><address style="text-align: right;"><small>
Generated on Tue Feb 15 23:51:57 2011 for Tesseroids 1.0: User manual and API documentation by&nbsp;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3</small></address>
</body>
</html>
