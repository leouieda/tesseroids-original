<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>
Tesseroids v1.0
</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/> 
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="logo.ico"/>
</head>

<body>

<table cellspacing=20>
    <tr>
    <td> <img src="logo.png" alt="Logo" height=50 width=50> </td>
    <td align="center"> <font size=6>
    <b>Tesseroids 1.0</b>: User Manual and API Documentation </font></td>
</table>

<div class="supertabs">
    <ul class="tablist">
        <li><a href="index.html"><span>Main&#160;Page</span></a>
            <ul class="subtablist">
                <li><a href="http://code.google.com/p/tesseroids"><span>Project site</span></a></li>
                <li><a href="http://code.google.com/p/tesseroids/downloads/list"><span>Download</span></a></li>
                <li><a href="http://www.gnu.org/licenses/gpl.html"><span>License</span></a></li>
            </ul>
        </li>
        <li><a href="userman.html"><span>User&#160;Manual</span></a>
            <ul class="subtablist">
                <li><a href="userman-theory.html"><span>Theory</span></a></li>
                <li><a href="userman-instal.html"><span>Intallation</span></a></li>
                <li><a href="userman-usage.html"><span>Usage</span></a></li>
            </ul>
        </li>
        <li><a href="apidocs.html"><span>API&#160;Documentation</span></a>
            <ul class="subtablist">
                <li><a href="files.html"><span>Files</span></a></li>
                <li><a href="annotated.html"><span>Data Structures</span></a></li>
                <li><a href="globals_func.html"><span>Functions</span></a></li>
                <li><a href="todo.html"><span>To do</span></a></li>
            </ul>
        </li>
    </ul>
</div>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="contents">


<h1><a class="anchor" id="userman-usage">Usage </a></h1> 
<table border=0>
<tr>
<td width="15%"></td>
<td>
<h2><a class="anchor" id="heights">
A note about heights and units</a></h2>
<p>In order to have a single convention, the word "height" means "height above the
Earths surface" and are interpreted as positive up and negative down, ie. oriented with the z axis of the Local coordinate system.</p>
<p>Also, all input units are in SI and decimal degrees. Output of tessg* programs are in mGal and Eotvos. All other output is also in SI and decimal degrees.</p>
<h2><a class="anchor" id="help">
Getting help information</a></h2>
<p>All programs accept the -h and --version flags. -h will print a help message describing the usage, input and output formats and options accepted. --verbose prints version and license information about the program.</p>
<h2><a class="anchor" id="tessg">
Computing the gravitational effect of a tesseroid</a></h2>
<p>The tessgx, tessgy, tessgz, tessgxx, etc. programs calculate the combined effect of a list of tesseroids on given computation points. The computation points are passed via standard input and do NOT have to be in a regular grid. This allows, for example, computation on points where data was measured. The values calulated are put in the last column of the input points and printed to standard output.</p>
<p>For example, if calculating <img class="formulaInl" alt="$ g_z $" src="form_38.png"/> on these points:</p>
<div class="fragment"><pre class="fragment">
lon1 lat1 height1 value1 othervalue1
lon2 lat2 height2 value2 othervalue2
...
lonN latN heightN valueN othervalueN
</pre></div><p>the output would look something like:</p>
<div class="fragment"><pre class="fragment">
lon1 lat1 height1 value1 othervalue1 gz1
lon2 lat2 height2 value2 othervalue2 gz2
...
lonN latN heightN valueN othervalueN gzN
</pre></div><p>The input model file should contain one tesseroid per line and have columns formated as:</p>
<div class="fragment"><pre class="fragment">
W E S N HEIGHT_OF_TOP HEIGHT_OF_BOTTOM DENSITY
</pre></div><p>HEIGHT_OF_TOP and HEIGHT_OF_BOTTOM are positive if the above the Earth's surface and negavitive if bellow. Remember that HEIGHT_OF_TOP &gt; HEIGHT_OF_BOTTOM!</p>
<p>Use the command line option -h to view a list of all commands available.</p>
<h3><a class="anchor" id="tess-example">
Example:</a></h3>
<p>Calculate the <img class="formulaInl" alt="$ g_z $" src="form_38.png"/> field of a tesseroid model having verbose printed and logged to file "gz.log" and <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> order 3/3/3.</p>
<div class="fragment"><pre class="fragment">
tessgz modelfile.txt -v -lgz.log -o3/3/3 &lt; points.txt &gt; gz_data.txt
</pre></div><h3><a class="anchor" id="tess-adapt">
The -a flag</a></h3>
<p>The -a flag on tessg* programs enables the automatic re-sizing of tesseroids when it is needed to maintain the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> precision desired. As a general rule, the tesseroid should be no bigger than it's distance from the computation point. Using this flag breaks the tesseroids automatically when this criterion is breached. This means that the computations can be performed with order 2/2/2 (default) which is much faster and still maintain correctness. Some preliminary tests show that using the -a flag with order 2/2/2 is up to 5 times faster than increasing the <a class="el" href="struct_g_l_q.html" title="Store the nodes and weights needed for a GLQ integration.">GLQ</a> order. <b>It is strongly recommended using this flag and 2/2/2 order always</b>.</p>
<h2><a class="anchor" id="verbose">
Verbose and logging to files</a></h2>
<p>The -v flag enables printing of information messages to stderr. If ommited, only error messages will appear.</p>
<p>The -l flag enables logging of information and error messages to a file.</p>
<h2><a class="anchor" id="comments">
Comments and provenance information</a></h2>
<p>Comments can be inserted into input files by placing a "#" character at the start of a line. All comment lines are ignored. tessg* programs print the comment lines of the input to standard output.</p>
<p>All programs insert comments about the provenance of their results (where they came from) to their output. These include names of input files, version of program used, date, etc.</p>
<h2><a class="anchor" id="grid">
Generating a regular grid</a></h2>
<p>Included in the package is program "tessgrd" which creates a regular grid of points and prints them to standard output.</p>
<h3><a class="anchor" id="grdiexample">
Example</a></h3>
<div class="fragment"><pre class="fragment">
tessgrd -r-10/10/-10/10 -b100/100 -z250e03 -v &gt; points.txt
</pre></div><h2><a class="anchor" id="modgen">
Automated model generation</a></h2>
<p>Tesseroids 1.0 includes a new program called "tessmodgen" for automatically generating a tesseroid model from a map of an interface. The interface can be any surface deviating from a reference level. For example, topography (a DEM) deviates from 0, a Moho map deviates from a mean crustal thickness, etc.</p>
<p>This program takes as input a REGULAR grid with longitude, latitude and height values of the interface. Each tesseroid is generated with a grid point at the center of it's top face. The top and bottom faces of the tesseroid are defined as:</p>
<ul>
<li>Top = Interface and Bottom = Reference: if the interface is above the reference</li>
<li>Top = Reference and Bottom = Interface: if the interface is bellow the reference</li>
</ul>
<p>The density <img class="formulaInl" alt="$ \rho $" src="form_27.png"/> of the tesseroids can be passed using the -d option. This will asign a density value of <img class="formulaInl" alt="$ \rho $" src="form_27.png"/> when the interface is above the reference and a value of <img class="formulaInl" alt="$ -\rho $" src="form_50.png"/> if the interface is bellow the reference.</p>
<p>Alternatively, the density of each tesseroid can be passed as a forth column on the input grid. <b>As with the -d option, if the interface is bellow the reference, the density value will be multiplied by -1!</b> Also, an error will occur if both a forth column and the -d option are passed!</p>
<h3><a class="anchor" id="modgen-ex">
Example:</a></h3>
<p>To generate a tesseroid model from a Digital Elevation Model (DEM) with <img class="formulaInl" alt="$ 1^\circ $" src="form_51.png"/> resolution using a density <img class="formulaInl" alt="$ \rho = 2.67\ g.cm^{-3} $" src="form_52.png"/>:</p>
<div class="fragment"><pre class="fragment">
tessmodgen -s1/1 -d2670 -z0 -v &lt; dem_file.txt &gt; dem_tess_model.txt
</pre></div><h2><a class="anchor" id="mass">
Calculating the total mass of a model</a></h2>
<p>The tessmass program can be used to compute the total mass of a given tesseroid model. If desired, a density range can be given and only tesseroids that fall within the given range will be used in the calculation.</p>
<h3><a class="anchor" id="mass-ex">
Example:</a></h3>
<p>To calculate the total mass of all tesseroids in "model.txt" with density between 0 and 1 g.cm^-3 :</p>
<div class="fragment"><pre class="fragment">
tessmass -r0/1000 &lt; model.txt
</pre></div><h2><a class="anchor" id="prismg">
Computing the gravitational effect of a rectangular prism</a></h2>
<p>Tesseroids 1.0 also introduces programs to calculate the gravitational effect of rectangular prisms in Cartesian coordinates. This is done using the formulas of Nagy <em> et al.</em> (2000). The programs are name prismgx, prismgy, prismgz, prismgxx, etc.</p>
<p>Input and output for these programs is very similar to that of the tessg* programs. Computation points are read from standard input and the prism model is read from a file. The model file should have the column format:</p>
<div class="fragment"><pre class="fragment">
X1 X2 Y1 Y2 Z1 Z2 DENSITY
</pre></div><h3><a class="anchor" id="prism-coords">
A note on the coordinate system</a></h3>
<p>As in Nagy <em> et al.</em> (2000), the coordinate system for the rectangular prism calculations has X axis pointing North, Y axis pointing East and Z axis pointing <b>Down</b>. This is important to note because it differs from the convention adopted for the tesseroids. In practice, this means that the <img class="formulaInl" alt="$ g_{xz} $" src="form_53.png"/> and <img class="formulaInl" alt="$ g_{yz} $" src="form_54.png"/> components of the prism and tesseroid will have different signs. This will not be such for the <img class="formulaInl" alt="$ g_{z} $" src="form_55.png"/> component, though, because the convention for tesseroids is to have Z axis Down for this component only. See the <a class="el" href="userman-theory.html">Theoretical background</a> section for more details on this.</p>
<h2><a class="anchor" id="pipe">
Piping</a></h2>
<p>Tesseroids was designed with the Unix filosophy in mind:</p>
<div class="fragment"><pre class="fragment">
Write programs that do one thing and do it well.
Write programs to work together.
Write programs to handle text streams, because that is a universal interface.
</pre></div><p>Therefore, all tessg* and tessgrd programs can be piped together to calculate many components on a regular grid.</p>
<h3><a class="anchor" id="pipe-example">
Example</a></h3>
<p>Given a tesseroids file "model.txt" as follows:</p>
<div class="fragment"><pre class="fragment">
-5 5 -5 5 0 -10e03 -500
</pre></div><p>Running the following would calculate <img class="formulaInl" alt="$ g_z $" src="form_38.png"/> and gradient tensor of tesseroids in "model.txt" of a regular grid from -10W to 10E and -10S to 10N on 100x100 points at 250 km height. And the best of all is that it is done in parallel! If your system has multiple cores this would mean a great increase in the computation time.</p>
<div class="fragment"><pre class="fragment">
tessgrd -r-10/10/-10/10 -b100/100 -z250e03 | tessgz model.txt -a | \
tessgxx model.txt -a | tessgxy model.txt -a | tessgxz model.txt -a | \
tessgyy model.txt -a | tessgyz model.txt -a | tessgzz model.txt -a &gt; output.txt
</pre></div><p>The result of this should look something like:</p>
<div align="center">
<img src="example.png" alt="example.png"/>
<p><strong>Plot of columns in result file output.txt (values in mGal and Eotvos).</strong></p></div>
<h2><a class="anchor" id="refs">
References</a></h2>
<ul>
<li>Nagy, D., Papp, G., Benedek, J. [2000]. The gravitational potential and its derivatives for the prism. Journal of Geodesy, 74, 552–560.</li>
</ul>
 
</td>
<td width="15%"></td>
</table>
 </div>
<hr class="footer"/><address style="text-align: right;"><small>
Generated on Tue Feb 15 23:51:57 2011 for Tesseroids 1.0: User manual and API documentation by&nbsp;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3</small></address>
</body>
</html>
